
# Серверная часть
 
 Серверная часть реализована через Firebase cloud functions.

 `checkWinner` - функция-триггер, которая реагирует на запись данных в Firestore. Эта функция определяет, когда игра завершилась и кто победитель. 

 ВАЖНО! Все скрипты необходимо выполнять из этой директории (`functions`)

## Установка

Перед разработкой необходимо произвести установку. Для установки зависимостей используйте:
```
npm install
```

## Разработка
Код написан на TypeScript (`src/index.ts`). Запустить разработку можно с помощью команды:

```
npm run watch
```

Для разработки Cloud Functions удобно использовать TDD. Для этого необходимо запустить в отдельных консолях эмулятор и процесс тестирования в режиме watch.

## Deploy
Опубликовать функции на firebase сервере можно с помощью команды:

```
npm run deploy
```

## Unit Тестирование

Unit тесты (`test/test.ts`) выполнены с помощью фреимверка `mocha`, а также `@firebase/testing` библиотеки и Emulator Suite. Для произведения тестов также понадобится [Firebase CLI](https://firebase.google.com/docs/cli).

### `npm run emulator`
Запускает UI эмуляторы:
* functions - http://localhost:4000/functions
* firestore - http://localhost:4000/firestore

Удобно для разработки тестов.

### `npm test`
Запускает процесс тестирования в режиме watch. Для процесса тестирования необходим запущенный эмулятор (в отдельной консоле).

Удобно для разработки тестов.

### `npm run test:ci`
Выполняет разовое тестирование запуская эмуляторы в фоне.

Может быть использовано для процесса непрерывной интеграции.
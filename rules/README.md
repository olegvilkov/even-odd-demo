
# Firestore Security Rules

Firestore Security Rules являются частью гарантии честной игры клиентов.

ВАЖНО! Все скрипты необходимо выполнять из этой директории (`rules`)

## Установка

Перед разработкой необходимо произвести установку. Для установки зависимостей используйте:
```
npm install
```

## Разработка TDD
Security Rules описаны в файле `firestore.rules`. Разработку Security Rules удобно производить способом TDD. Unit тесты написаны на TypeScript (`./test/`) с использованием фреимверка `mocha` и эмулятора firestore в фоновом режиме. Запустить тестирование Security Rules в режиме watch можно с помощью команды:

```
npm test
```
Для вывода информации из firestore.rules можно использовать `debug()`. Лог будет доступен в файле `firestore-debug.log`.

## Deploy
Опубликовать Security Rules можно с помощью команды:

```
npm run deploy
```

## Дополнительные возможности

### `npm run test:mocha`
Запустит разовое тестирование без запуска эмулятора в фоне. Удобно использовать вместе с запущенным эмулятором в отдельной консоле (`npm run emulator`)

### `npm run test:watch`
Запустит тестирование в режиме watch, без запуска эмулятора в фоне. Удобно использовать вместе с запущенным эмулятором в отдельной консоле (`npm run emulator`)

### `npm run emulator`
Запустит UI emulator. Удобно использовать если необходимо наблюдать структуру данных после теста. Не работает вместе с фоновым эмулятором.

### `npm run test:ci`
Выполнит разовое тестирование запуская эмулятор firestore в фоне. 
Может быть использовано для процесса непрерывной интеграции.